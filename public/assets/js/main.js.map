{"version":3,"sources":["main.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"main.js","sourcesContent":["'use strict';\n\nconst FAVORITES_KEY = 'favorites';\nlet showResultsContainer = document.body.querySelector('#show-results');\nlet showInputElem = document.body.querySelector('#show-input');\nlet searchShowButton = document.body.querySelector('#search-show');\nlet errorBlock = document.body.querySelector('#error');\n\nfunction getLocalStorageFavorites() {\n  let favorites = localStorage.getItem(FAVORITES_KEY) || '[]';\n  return JSON.parse(favorites);\n}\n\nfunction addFavorite(showId) {\n  let favorites = getLocalStorageFavorites();\n  favorites.push(showId);\n\n  localStorage.setItem(FAVORITES_KEY, JSON.stringify(favorites));\n}\n\nfunction removeFavorite(showId) {\n  let favorites = getLocalStorageFavorites();\n  let indexToDelete = favorites.indexOf(showId);\n  if (indexToDelete !== -1) {\n    favorites.splice(indexToDelete, 1);\n  }\n  localStorage.setItem(FAVORITES_KEY, JSON.stringify(favorites));\n}\n\nfunction hasFavorite(showId) {\n  let favorites = getLocalStorageFavorites();\n  if (favorites.indexOf(showId.toString()) !== -1) {\n    return true;\n  }\n  return false;\n}\n\nfunction toggleFavorite(event) {\n  let toggledResultItem = event.currentTarget;\n  toggledResultItem.classList.toggle('show-result-item-active');\n\n  let showId = toggledResultItem.dataset.showId;\n\n  if (showId) {\n    if (toggledResultItem.classList.contains('show-result-item-active')) {\n      addFavorite(showId);\n    } else {\n      removeFavorite(showId);\n    }\n  }\n}\n\nfunction searchShow() {\n  let query = showInputElem.value;\n  showResultsContainer.innerHTML = '';\n\n  fetch(`https://api.tvmaze.com/search/shows?q=${query}`)\n    .then(response => response.json())\n    .then(response => {\n      if (response.length === 0) {\n        errorBlock.innerText =\n          'No se han encontrado resultados para esta b√∫squeda';\n      } else {\n        errorBlock.innerText = '';\n      }\n\n      for (const showData of response) {\n        let show = showData.show;\n        let showName = show.name;\n        let showImage;\n        if (show.image && show.image.medium) {\n          showImage = show.image.medium;\n        } else {\n          showImage = `https://via.placeholder.com/210x295/cccccc/666666/?text=TV`;\n        }\n\n        let showResultItem = document.createElement('li');\n        showResultItem.className = 'show-result-item';\n\n        if (hasFavorite(show.id)) {\n          showResultItem.classList.add('show-result-item-active');\n        }\n\n        showResultItem.dataset.showId = show.id;\n\n        let showImageElem = document.createElement('img');\n        showImageElem.src = showImage;\n        showResultItem.appendChild(showImageElem);\n\n        let showTitleElem = document.createElement('h2');\n        let showTitleText = document.createTextNode(showName);\n        showTitleElem.appendChild(showTitleText);\n        showResultItem.appendChild(showTitleElem);\n\n        showResultItem.addEventListener('click', toggleFavorite);\n\n        showResultsContainer.appendChild(showResultItem);\n      }\n    });\n}\n\nsearchShowButton.addEventListener('click', searchShow);\n"]}